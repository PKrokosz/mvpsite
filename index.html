<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GLITCHWAVE // NEURAL ENTRY</title>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="overlay"></div>
  <div id="terminal" class="terminal"></div>
  <script src="luna_profiles.js"></script>
  <script src="terminal_router.js"></script>
  <script>
    const terminal = document.getElementById("terminal");

    const intro = [
      "// NIGHT CITY NEURAL ENTRY NODE",
      "// USER_HASH: 0x3ACF28...",
      "SESSION ID: ðŸœ-VERTEBRAE-9X1A",
      "",
      "â†’ booting_sequence . . . [OK]",
      "â†’ signal_lock:luna.core . . . [LINKED]",
      "â†’ profile_cache: mila / krokiet / donka / luna / rabur",
      "",
      "> TYPE `inject profile:donka` OR `help`"
    ];

    const messageTemplates = [
      "// [REKLAMA] {product} â€“ {slogan}",
      "// [EVENT] DziÅ› w {district}: {event}, tylko z {sponsor}!",
      "// [INFO] {ai} zarejestrowaÅ‚a {anomaly} w {district}.",
      "// [SYS] {username} {action} przy {location}.",
      "// [ZAPIS] Transmisja z {place} zostaÅ‚a {result}.",
      "// [AD] Kup {item} â€“ teraz z {feature} i {bonus}!"
    ];

    const variables = {
      product: ["CyberPineappleâ„¢", "NeuroLustâ„¢", "ChromeSmileÂ®", "Synaptic Tea"],
      slogan: ["smak przyszÅ‚oÅ›ci!", "odblokuj zmysÅ‚y!", "teraz z opcjÄ… uczuÄ‡!", "dostrojony do emocji!"],
      district: ["JAPANTOWN", "DOGTOWN", "WATSON", "SANTO DOMINGO", "WESTBROOK", "CITY CENTER"],
      event: ["turniej nadludzkich szachÃ³w", "rozgrywki mechÃ³w", "rzeÅºbienie pamiÄ™ci w chmurze"],
      sponsor: ["Biotechnica", "Netwatch", "Orbit-8"],
      ai: ["LUNA", "KROKOSZ_CORE", "SYNAPTRIX"],
      anomaly: ["duplikacjÄ™ osobowoÅ›ci", "przekroczenie limitu snu", "rozszczepienie pamiÄ™ci"],
      username: ["Rabur", "Mila", "Donka", "Nieznany Fixer"],
      action: ["zniknÄ…Å‚ z siatki", "otworzyÅ‚ ukryty kanaÅ‚", "zostaÅ‚ powielony"],
      location: ["wieÅ¼a transmisyjna w Watson", "podziemia Glitchcore", "archiwum SnÃ³w"],
      place: ["Vertebrae", "Node 404", "sieÄ‡ typu B"],
      result: ["przejÄ™ta przez niezidentyfikowany byt", "wyciszona", "skompresowana do 12 bajtÃ³w"],
      item: ["proteza twarzy", "wspomnienie matki", "neurofon turbo"],
      feature: ["kontrolÄ… emocji", "automatycznym stylem"],
      bonus: ["punktem empatii za kaÅ¼de uÅ¼ycie", "legalizacjÄ… w Night City"]
    };

    function generateAmbientMessage() {
      const template = messageTemplates[Math.floor(Math.random() * messageTemplates.length)];
      return template.replace(/\{(.*?)\}/g, (_, key) => {
        const list = variables[key];
        return list ? list[Math.floor(Math.random() * list.length)] : key;
      });
    }

    let i = 0;
    function animateIntro() {
      if (i < intro.length) {
        const line = document.createElement("div");
        line.textContent = intro[i];
        line.classList.add("terminal-line");
        terminal.appendChild(line);
        i++;
        setTimeout(animateIntro, 100);
      } else {
        createInput();
        startIdleAmbient();
      }
    }

    function createInput() {
      const wrapper = document.createElement("div");
      wrapper.classList.add("input-wrapper");

      const prompt = document.createElement("span");
      prompt.textContent = "> ";
      wrapper.appendChild(prompt);

      const input = document.createElement("input");
      input.classList.add("terminal-input");
      wrapper.appendChild(input);

      terminal.appendChild(wrapper);
      input.focus();

      input.addEventListener("keydown", (e) => {
        switch (e.key) {
          case "Enter": {
            const command = input.value.trim().toLowerCase();
            const echo = document.createElement("div");
            echo.textContent = "> " + command;
            echo.classList.add("terminal-line");
            terminal.insertBefore(echo, wrapper);
            input.disabled = true;
            routeCommand(command);
            clearTimeout(idleTimeout);
            setTimeout(() => {
              createInput();
              terminal.scrollTop = terminal.scrollHeight;
            }, 300);
            break;
          }
          default:
            break;
        }
      });
    }

    let idleTimeout;
    function startIdleAmbient() {
      idleTimeout = setTimeout(() => {
        const msg = generateAmbientMessage();
        const line = document.createElement("div");
        line.textContent = msg;
        line.classList.add("terminal-line", "ambient-message");
        terminal.appendChild(line);
        terminal.scrollTop = terminal.scrollHeight;
        startIdleAmbient();
      }, 8000);
    }

    animateIntro();
  </script>
</body>
</html>
