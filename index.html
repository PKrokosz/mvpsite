<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GLITCHWAVE // NEURAL ENTRY</title>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="overlay"></div>
  <div id="terminal" class="terminal"></div>
  <!-- core routing + extras -->
  <script src="terminal_router_final.js"></script>
  <script src="profile_extras.js"></script>
  <script>
    /* ----------  INTRO & INPUT ---------- */
    const terminal = document.getElementById("terminal");

    const intro = [
      "// NIGHT CITY NEURAL ENTRY NODE",
      "// USER_HASH: 0x3ACF28...",
      "SESSION ID: ðŸœ-VERTEBRAE-9X1A",
      "â†’ booting_sequence . . . [OK]",
      "â†’ signal_lock:luna.core . . . [LINKED]",
      "â†’ profile_cache: mila / krokiet / donka / rabur / luna",
      "> TYPE `inject profile:donka` OR `help`"
    ];

    const ambientTemplates = [
      "// [REKLAMA] {product} â€“ {slogan}",
      "// [EVENT] {district}: {event} sponsor: {sponsor}",
      "// [INFO] {ai} wykryÅ‚a {anomaly} w {district}.",
      "// [ZAPIS] {username} {action} ({location})."
    ];
    const v = {
      product:["CyberPineappleâ„¢","ChromeSmileÂ®","NeuroLustâ„¢"],
      slogan:["odblokuj zmysÅ‚y!","smak przyszÅ‚oÅ›ci!","teraz z uczuciami!"],
      district:["JAPANTOWN","DOGTOWN","WATSON","SANTO DOMINGO"],
      event:["walki mechÃ³w","neonâ€‘rave","aukcja wspomnieÅ„"],
      sponsor:["Arasaka","Biotechnica","Orbitâ€‘8"],
      ai:["LUNA","DONKA","SYNAPTRIX"],
      anomaly:["rozszczepienie pamiÄ™ci","duplikacjÄ™ osobowoÅ›ci","glitch sensoryczny"],
      username:["Rabur","Krokiet","Mila"],
      action:["zniknÄ…Å‚ z sieci","otworzyÅ‚ ukryty kanaÅ‚","wysÅ‚aÅ‚ echo"],
      location:["wieÅ¼a Watson","Vertebrae","GlitchCore"]
    };
    function rand(arr){return arr[Math.floor(Math.random()*arr.length)];}
    function ambientMsg(){return ambientTemplates[Math.floor(Math.random()*ambientTemplates.length)].replace(/\{(.*?)\}/g,(m,k)=>rand(v[k]));}

    let idle;
    function introAnim(i=0){
      if(i<intro.length){addLine(intro[i]);setTimeout(()=>introAnim(i+1),90);}else{createInput();startIdle();}}

    function addLine(t){const d=document.createElement("div");d.textContent=t;d.classList.add("terminal-line");terminal.appendChild(d);terminal.scrollTop=terminal.scrollHeight;}

    function createInput(){const wrap=document.createElement("div");wrap.classList.add("input-wrapper");const p=document.createElement("span");p.textContent="> ";wrap.appendChild(p);const inp=document.createElement("input");inp.classList.add("terminal-input");wrap.appendChild(inp);terminal.appendChild(wrap);inp.focus();
      inp.addEventListener("keydown",e=>{if(e.key==="Enter"){const cmd=inp.value.trim().toLowerCase();if(cmd){addLine("> "+cmd);}inp.disabled=true;clearTimeout(idle);
        const handledExtras=typeof routeCommandExtended==="function" && routeCommandExtended(cmd);
        if(!handledExtras){routeCommand(cmd);}setTimeout(()=>{createInput();startIdle();},200);}});}      
    function startIdle(){idle=setTimeout(()=>{addLine(ambientMsg());startIdle();},9000);}    

    introAnim();
  </script>
</body>
</html>
